"use strict";(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[160],{3160:function(e,t,a){a.d(t,{Z:function(){return M}});var i=a(3396),s=a(9242);const o={key:0,class:"h4 mb-4"},l={key:1,class:"h4 mb-4"},d=(0,i.Uk)("ID "),n={class:"col-sm-2"},r=(0,i.Uk)("Tahun "),m=(0,i._)("span",{class:"text-red-500"},"*",-1),p={class:"col-sm-2"},u=(0,i.Uk)("Nama Sektor "),c=(0,i._)("span",{class:"text-red-500"},"*",-1),h={class:"col-sm-9"},k=(0,i.Uk)("Nama Tema "),f=(0,i._)("span",{class:"text-red-500"},"*",-1),w={class:"col-sm-9"},T=(0,i.Uk)("Nama Topik "),b=(0,i._)("span",{class:"text-red-500"},"*",-1),g={class:"col-sm-9"},_=(0,i.Uk)("Informasi Topik Yang Diharapkan "),S=(0,i._)("span",{class:"text-red-500"},"*",-1),W={class:"col-sm-9"},y=(0,i._)("p",{class:"text-sm mt-2 text-red-500"}," note : pisahkan informasi topik dengan titik koma ';' ",-1),v=(0,i.Uk)("Kedeputian Koord Topik "),U=(0,i._)("span",{class:"text-red-500"},"*",-1),D={class:"col-sm-9"},V=(0,i.Uk)("Unit Kerja PJ Topik "),$=(0,i._)("span",{class:"text-red-500"},"*",-1),C={class:"col-sm-9"},x=(0,i.Uk)("Triwulan Pelaporan Topik "),j=(0,i._)("span",{class:"text-red-500"},"*",-1),K={class:"col-sm-4"},R=(0,i.Uk)(" Batal "),I=(0,i.Uk)(" Reset "),L={key:0},P=(0,i.Uk)(" Simpan "),F={key:1};function E(e,t,a,E,B,q){const A=(0,i.up)("Loading"),N=(0,i.up)("CFormLabel"),O=(0,i.up)("CFormInput"),Z=(0,i.up)("CRow"),G=(0,i.up)("VueMultiselect"),M=(0,i.up)("CFormTextarea"),H=(0,i.up)("CButton"),Y=(0,i.up)("CCol"),z=(0,i.up)("CSpinner"),J=(0,i.up)("CForm"),Q=(0,i.up)("CCardBody"),X=(0,i.up)("CCard");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(A,{active:B.loading,"onUpdate:active":t[0]||(t[0]=e=>B.loading=e),"is-full-page":!0},null,8,["active"]),(0,i.Wm)(X,{class:"mb-4"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{class:"p-4"},{default:(0,i.w5)((()=>["create"==a.mode?((0,i.wg)(),(0,i.iD)("h4",o,"Tambah Topik")):"update"==a.mode?((0,i.wg)(),(0,i.iD)("h4",l,"Edit Topik")):(0,i.kq)("",!0),"update"==a.mode?((0,i.wg)(),(0,i.j4)(Z,{key:2,class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(N,{for:"tahun",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[d])),_:1}),(0,i._)("div",n,[(0,i.Wm)(O,{modelValue:B.editData.idTopik,"onUpdate:modelValue":t[1]||(t[1]=e=>B.editData.idTopik=e),readonly:""},null,8,["modelValue"])])])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(J,{onSubmit:(0,s.iM)(q.submit,["prevent"])},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(N,{for:"tahun",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[r,m])),_:1}),(0,i._)("div",p,[(0,i.Wm)(O,{type:"number",id:"tahun",modelValue:B.form.tahun,"onUpdate:modelValue":t[2]||(t[2]=e=>B.form.tahun=e),readonly:"",required:""},null,8,["modelValue"])])])),_:1}),(0,i.Wm)(Z,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(N,{for:"nama-sektor",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[u,c])),_:1}),(0,i._)("div",h,[(0,i.Wm)(G,{id:"nama-sektor",modelValue:B.selectedSektor,"onUpdate:modelValue":t[3]||(t[3]=e=>B.selectedSektor=e),options:B.optionsSektor,placeholder:"Pilih Sektor",label:"deskripsi","track-by":"deskripsi","custom-label":q.viewSelectSektor},null,8,["modelValue","options","custom-label"])])])),_:1}),(0,i.Wm)(Z,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(N,{for:"nama-tema",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[k,f])),_:1}),(0,i._)("div",w,[(0,i.Wm)(G,{id:"nama-tema",modelValue:B.selectedTema,"onUpdate:modelValue":t[4]||(t[4]=e=>B.selectedTema=e),options:B.optionsTema,placeholder:"Pilih Tema",label:"deskripsi","track-by":"deskripsi","custom-label":q.viewSelectTema},null,8,["modelValue","options","custom-label"])])])),_:1}),(0,i.Wm)(Z,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(N,{for:"nama-topik",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[T,b])),_:1}),(0,i._)("div",g,[(0,i.Wm)(O,{type:"text",id:"nama-topik",modelValue:B.form.namaTopik,"onUpdate:modelValue":t[5]||(t[5]=e=>B.form.namaTopik=e),required:""},null,8,["modelValue"])])])),_:1}),(0,i.Wm)(Z,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(N,{for:"info-topik",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[_,S])),_:1}),(0,i._)("div",W,[(0,i.Wm)(M,{id:"info-topik",rows:"3",modelValue:B.form.deskripsi,"onUpdate:modelValue":t[6]||(t[6]=e=>B.form.deskripsi=e),required:"",placeholder:"Info A; Info B; Info C;"},null,8,["modelValue"]),y])])),_:1}),(0,i.Wm)(Z,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(N,{for:"deputi-topik",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[v,U])),_:1}),(0,i._)("div",D,[(0,i.Wm)(O,{type:"text",id:"dep-topik",value:B.viewDeputi,readonly:""},null,8,["value"])])])),_:1}),(0,i.Wm)(Z,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(N,{for:"pj-topik",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[V,$])),_:1}),(0,i._)("div",C,[(0,i.Wm)(G,{id:"pj-topik",modelValue:B.selectedRendal,"onUpdate:modelValue":t[7]||(t[7]=e=>B.selectedRendal=e),options:B.optionsRendal,placeholder:"Pilih Unit Kerja Penanggungjawab",label:"deskripsi","track-by":"deskripsi","custom-label":q.viewSelectSearch},null,8,["modelValue","options","custom-label"])])])),_:1}),(0,i.Wm)(Z,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(N,{for:"tw-topik",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[x,j])),_:1}),(0,i._)("div",K,[(0,i.Wm)(G,{id:"tw-topik",modelValue:B.form.triwulan,"onUpdate:modelValue":t[8]||(t[8]=e=>B.form.triwulan=e),options:B.optionsTriwulan,multiple:!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pilih Triwulan"},null,8,["modelValue","options"])])])),_:1}),(0,i.Wm)(Z,{class:"mt-8 view-form"},{default:(0,i.w5)((()=>[(0,i.Wm)(Y,{sm:"12",lg:"6",class:"mb-3"},{default:(0,i.w5)((()=>["view"!=a.mode?((0,i.wg)(),(0,i.j4)(H,{key:0,variant:"outline",color:"dark",onClick:t[9]||(t[9]=t=>e.$router.push("/topik")),class:"px-5"},{default:(0,i.w5)((()=>[R])),_:1})):(0,i.kq)("",!0)])),_:1}),"create"==a.mode||"update"==a.mode?((0,i.wg)(),(0,i.j4)(Y,{key:0,sm:"12",md:"6",class:"flex content-center justify-end pr-3 mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{type:"button",class:"ml-1 px-5 text-white",color:"danger",onClick:q.reset},{default:(0,i.w5)((()=>[I])),_:1},8,["onClick"]),(0,i.Wm)(H,{type:"submit",color:"info",class:"px-5 ml-2 text-white"},{default:(0,i.w5)((()=>[B.loading?((0,i.wg)(),(0,i.iD)("div",L,[(0,i.Wm)(z,{color:"white",size:"sm",class:"mr-2"}),P])):((0,i.wg)(),(0,i.iD)("p",F,"Simpan"))])),_:1})])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})],64)}var B=a(6265),q=a.n(B),A=a(6368),N=a(6216),O={components:{VueMultiselect:A.ZP,Loading:N.Z},props:["mode","idTopik"],data(){return{form:this.getEmptyForm(),submitted:!1,loading:!1,selectedSektor:null,optionsSektor:[],selectedTema:null,optionsTema:[],viewDeputi:null,selectedRendal:null,optionsRendal:[],optionsTriwulan:[1,2,3,4],editData:{}}},watch:{selectedSektor:function(e){e&&(this.form.idSektor=e.idSektor,this.selectedTema="",this.getListTema())},selectedTema:function(e){e&&(this.form.idTema=e.idTema)},selectedRendal:function(e){e&&(this.form.idUnitKerja=e.id,this.form.idKedeputian=e.parentId,this.viewDeputi=`${e.deputi} - ${e.namaDeputi}`)}},async mounted(){if(this.form.tahun=localStorage.tahun,this.optionsSektor=await this.$store.dispatch("loadListSektor"),this.optionsRendal=await this.$store.dispatch("loadListUnitKontributor"),"update"==this.mode){this.loading=!0,await this.loadTopikById();const e=this.optionsSektor.filter((e=>e.idSektor==this.form.idSektor));this.selectedSektor=e[0],await this.getListTema();const t=this.optionsTema.filter((e=>e.idTema==this.form.idTema));this.selectedTema=t[0];const a=this.optionsRendal.filter((e=>e.id==this.form.idUnitKerja));this.selectedRendal=a[0]}},methods:{async getListTema(){this.optionsTema=await this.$store.dispatch("loadListTema",{idSektor:this.form.idSektor})},viewSelectSektor({namaSektor:e}){return`${e}`},viewSelectTema({namaTema:e}){return`${e}`},viewSelectSearch({alias:e,deskripsi:t}){return`${e} - ${t}`},async submit(){const e=this.$func.isNullOfObjElement(this.form);if(e){this.submitted=!0;const e=this.appendToFormData();try{if("create"==this.mode){this.loading=!0;const t=await q()({method:"POST",baseURL:this.$apiAddress,url:"/api/topik",data:e,params:{token:localStorage.getItem("token")}});200!=t.status?this.error="Gagal menyimpan data":(this.loading=!1,this.$router.push("/topik"),this.toastSuccess("Berhasil menyimpan data"))}else if("update"==this.mode){this.loading=!0;const t=await q()({method:"POST",baseURL:this.$apiAddress,url:`/api/topik/${this.idTopik}`,data:e,params:{token:localStorage.getItem("token")}});200!=t.status?this.error="Gagal merubah data":(this.loading=!1,this.$router.push("/topik"),this.toastSuccess("Berhasil merubah data"))}}catch(t){setTimeout((()=>{this.loading=!1,this.toastError("Terjadi kesalahan saat submit data")}),500)}}else this.toastWarning("Lengkapi data sebelum submit!")},reset(){this.form=this.getEmptyForm(),this.submitted=!1,this.selectedSektor=null,this.selectedTema=null,this.viewDeputi=null,this.selectedRendal=null},getEmptyForm(){return{tahun:null,idSektor:null,idTema:null,namaTopik:null,deskripsi:null,idKedeputian:null,idUnitKerja:null,triwulan:null}},appendToFormData(){const e=new FormData;return"update"==this.mode&&e.append("_method","PATCH"),e.append("idSektor",this.form.idSektor),e.append("idTema",this.form.idTema),e.append("namaTopik",this.form.namaTopik),e.append("deskripsi",this.form.deskripsi),e.append("idKedeputian",this.form.idKedeputian),e.append("idUnitKerja",this.form.idUnitKerja),e.append("tahun",this.form.tahun),e.append("triwulan",this.form.triwulan),e.append("nip",localStorage.getItem("nip")),e},async loadTopikById(){try{const e=await q()({method:"GET",baseURL:this.$apiAddress,url:`/api/topik/${this.idTopik}`,params:{token:localStorage.getItem("token")}});this.editData=await e.data,200==e.status&&(this.form={tahun:this.editData.tahun,idSektor:this.editData.idSektor,idTema:this.editData.idTema,namaTopik:this.editData.namaTopik,deskripsi:this.editData.deskripsi,idKedeputian:this.editData.idKedeputian,idUnitKerja:this.editData.idUnitKerja,triwulan:this.editData.triwulan}),this.loading=!1}catch(e){this.toastError(e.message),this.loading=!1}},toastSuccess(e){this.$toast.open({message:e,type:"success",position:"top-right",duration:3e3})},toastError(e){this.$toast.open({message:e,type:"error",position:"top-right",duration:3e3})},toastWarning(e){this.$toast.open({message:e,type:"warning",position:"top-right",duration:3e3})}}},Z=a(89);const G=(0,Z.Z)(O,[["render",E]]);var M=G}}]);
//# sourceMappingURL=160.25a4cba9.js.map