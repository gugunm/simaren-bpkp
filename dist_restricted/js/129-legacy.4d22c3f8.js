"use strict";(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[129],{20129:function(t,e,a){a.d(e,{Z:function(){return X}});var n=a(73396),i=a(49242),o=a(87139),r={key:0,class:"h4 mb-4"},s={key:1,class:"h4 mb-4"},l=(0,n.Uk)("ID "),u={class:"col-sm-2"},p=(0,n.Uk)("Tahun "),d=(0,n._)("span",{class:"text-red-500"},"*",-1),c={class:"col-sm-2"},m=(0,n.Uk)("Nama KAP "),f=(0,n._)("span",{class:"text-red-500"},"*",-1),k={class:"col-sm-9"},h=(0,n.Uk)("Unit Kerja PJ KAP "),g=(0,n._)("span",{class:"text-red-500"},"*",-1),x={class:"col-sm-9"},b={class:"flex col-sm-12"},w=(0,n.Uk)(" Tambah "),T={class:"flex flex-col"},_={class:"-my-2 sm:-mx-6 lg:-mx-8"},y={class:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8"},v={class:"shadow-sm border-b border-gray-200 sm:rounded-lg"},K={class:"w-full divide-y divide-gray-200"},U=(0,n._)("thead",{class:"bg-gray-50"},[(0,n._)("tr",null,[(0,n._)("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nama Topik "),(0,n._)("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," PJ Topik "),(0,n._)("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Informasi Topik Yang Diharapkan "),(0,n._)("th",{scope:"col",class:"relative px-6 py-3"},[(0,n._)("span",{class:"sr-only"},"Hapus")])])],-1),W={class:"bg-white divide-y divide-gray-200"},D={key:0},R=(0,n._)("td",{colspan:"4"},[(0,n._)("div",{class:"py-3 text-center text-gray-700"}," Belum ada data ")],-1),C=[R],S={class:"px-6 py-2"},j={class:"text-sm text-gray-900"},V={class:"px-6 py-2 whitespace-nowrap"},P={class:"text-sm text-gray-900"},$={class:"px-6 py-2"},L={class:"text-sm break-normal text-gray-900"},E={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},O=["onClick"],F=(0,n.Uk)(" Batal "),I=(0,n.Uk)(" Reset "),A={key:0},B=(0,n.Uk)(" Simpan "),Z={key:1};function q(t,e,a,R,q,z){var H=(0,n.up)("Loading"),N=(0,n.up)("CFormLabel"),G=(0,n.up)("CFormInput"),J=(0,n.up)("CRow"),M=(0,n.up)("VueMultiselect"),Y=(0,n.up)("CButton"),Q=(0,n.up)("CCol"),X=(0,n.up)("CSpinner"),tt=(0,n.up)("CForm"),et=(0,n.up)("CCardBody"),at=(0,n.up)("CCard");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(H,{active:q.loading,"onUpdate:active":e[0]||(e[0]=function(t){return q.loading=t}),"is-full-page":!0},null,8,["active"]),(0,n.Wm)(at,{class:"mb-4"},{default:(0,n.w5)((function(){return[(0,n.Wm)(et,{class:"p-4"},{default:(0,n.w5)((function(){return["create"==a.mode?((0,n.wg)(),(0,n.iD)("h4",r,"Tambah KAP")):"update"==a.mode?((0,n.wg)(),(0,n.iD)("h4",s,"Edit KAP")):(0,n.kq)("",!0),"update"==a.mode?((0,n.wg)(),(0,n.j4)(J,{key:2,class:"mb-3"},{default:(0,n.w5)((function(){return[(0,n.Wm)(N,{for:"tahun",class:"col-sm-3 col-form-label"},{default:(0,n.w5)((function(){return[l]})),_:1}),(0,n._)("div",u,[(0,n.Wm)(G,{modelValue:q.editData.idKap,"onUpdate:modelValue":e[1]||(e[1]=function(t){return q.editData.idKap=t}),readonly:""},null,8,["modelValue"])])]})),_:1})):(0,n.kq)("",!0),(0,n.Wm)(tt,{onSubmit:(0,i.iM)(z.submit,["prevent"])},{default:(0,n.w5)((function(){return[(0,n.Wm)(J,{class:"mb-3"},{default:(0,n.w5)((function(){return[(0,n.Wm)(N,{for:"tahun",class:"col-sm-3 col-form-label"},{default:(0,n.w5)((function(){return[p,d]})),_:1}),(0,n._)("div",c,[(0,n.Wm)(G,{type:"number",id:"tahun",modelValue:q.form.tahun,"onUpdate:modelValue":e[2]||(e[2]=function(t){return q.form.tahun=t}),readonly:"",required:""},null,8,["modelValue"])])]})),_:1}),(0,n.Wm)(J,{class:"mb-3"},{default:(0,n.w5)((function(){return[(0,n.Wm)(N,{for:"nama-kap",class:"col-sm-3 col-form-label"},{default:(0,n.w5)((function(){return[m,f]})),_:1}),(0,n._)("div",k,[(0,n.Wm)(G,{type:"text",id:"nama-kap",modelValue:q.form.namaKap,"onUpdate:modelValue":e[3]||(e[3]=function(t){return q.form.namaKap=t}),required:""},null,8,["modelValue"])])]})),_:1}),(0,n.Wm)(J,{class:"mb-4"},{default:(0,n.w5)((function(){return[(0,n.Wm)(N,{for:"pj-kap",class:"col-sm-3 col-form-label"},{default:(0,n.w5)((function(){return[h,g]})),_:1}),(0,n._)("div",x,[(0,n.Wm)(M,{id:"pj-kap",modelValue:q.selectedRendal,"onUpdate:modelValue":e[4]||(e[4]=function(t){return q.selectedRendal=t}),options:q.optionsRendal,placeholder:"Pilih PJ KAP",label:"deskripsi","track-by":"deskripsi","custom-label":z.viewSelectSearch},null,8,["modelValue","options","custom-label"])])]})),_:1}),(0,n.Wm)(J,{class:"mb-4 view-form"},{default:(0,n.w5)((function(){return[(0,n._)("div",b,[(0,n.Wm)(M,{id:"nama-topik",modelValue:q.selectedTopik,"onUpdate:modelValue":e[5]||(e[5]=function(t){return q.selectedTopik=t}),options:q.currentOptionsTopik,placeholder:"Pilih Topik",label:"namaTopik","track-by":"namaTopik",deselectLabel:"",selectLabel:""},null,8,["modelValue","options"]),(0,n.Wm)(Y,{type:"button",class:"ml-3 px-4 text-white",color:"success",size:"sm",onClick:e[6]||(e[6]=function(t){return z.addTopik(q.idTopik)})},{default:(0,n.w5)((function(){return[w]})),_:1})])]})),_:1}),(0,n._)("div",T,[(0,n._)("div",_,[(0,n._)("div",y,[(0,n._)("div",v,[(0,n._)("table",K,[U,(0,n._)("tbody",W,[0==q.topiks.length?((0,n.wg)(),(0,n.iD)("tr",D,C)):((0,n.wg)(!0),(0,n.iD)(n.HY,{key:1},(0,n.Ko)(q.topiks,(function(t){return(0,n.wg)(),(0,n.iD)("tr",{key:t.nama},[(0,n._)("td",S,[(0,n._)("div",j,(0,o.zw)(t.nama),1)]),(0,n._)("td",V,[(0,n._)("div",P,(0,o.zw)(t.pj),1)]),(0,n._)("td",$,[(0,n._)("p",L,(0,o.zw)(t.deskripsi),1)]),(0,n._)("td",E,[(0,n._)("button",{class:"text-red-600 hover:text-red-900",onClick:function(e){return z.hapusTopikLokal(t.idTopik)}}," Hapus ",8,O)])])})),128))])])])])])]),(0,n.Wm)(J,{class:"mt-8 view-form"},{default:(0,n.w5)((function(){return[(0,n.Wm)(Q,{sm:"12",lg:"6",class:"mb-3"},{default:(0,n.w5)((function(){return["view"!=a.mode?((0,n.wg)(),(0,n.j4)(Y,{key:0,variant:"outline",color:"dark",onClick:e[7]||(e[7]=function(e){return t.$router.push("/kap")}),class:"px-5"},{default:(0,n.w5)((function(){return[F]})),_:1})):(0,n.kq)("",!0)]})),_:1}),"create"==a.mode||"update"==a.mode?((0,n.wg)(),(0,n.j4)(Q,{key:0,sm:"12",md:"6",class:"flex content-center justify-end pr-3 mb-3"},{default:(0,n.w5)((function(){return[(0,n.Wm)(Y,{type:"button",class:"ml-1 px-5 text-white",color:"danger",onClick:z.reset},{default:(0,n.w5)((function(){return[I]})),_:1},8,["onClick"]),(0,n.Wm)(Y,{type:"submit",color:"info",class:"px-5 ml-2 text-white"},{default:(0,n.w5)((function(){return[q.loading?((0,n.wg)(),(0,n.iD)("div",A,[(0,n.Wm)(X,{color:"white",size:"sm",class:"mr-2"}),B])):((0,n.wg)(),(0,n.iD)("p",Z,"Simpan"))]})),_:1})]})),_:1})):(0,n.kq)("",!0)]})),_:1})]})),_:1},8,["onSubmit"])]})),_:1})]})),_:1})],64)}var z=a(48534),H=(a(36133),a(57327),a(41539),a(54747),a(21249),a(74916),a(23123),a(9653),a(92222),a(26699),a(32023),a(40561),a(39714),a(56265)),N=a.n(H),G=a(16368),J=a(6216),M={components:{Loading:J.Z,VueMultiselect:G.ZP},props:["mode","idKap"],data:function(){return{form:this.getEmptyForm(),submitted:!1,loading:!1,selectedRendal:null,optionsRendal:[],selectedTopik:null,idTopik:null,optionsTopik:[],currentOptionsTopik:[],editData:{},topiks:[]}},watch:{selectedRendal:function(t){t&&(this.form.idUnitKerjaKap=t.id)},selectedTopik:function(t){t&&(this.idTopik=t.idTopik)}},mounted:function(){var t=this;return(0,z.Z)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.form.tahun=localStorage.tahun,e.next=3,t.$store.dispatch("loadListUnitKontributor");case 3:if(t.optionsRendal=e.sent,"create"!=t.mode){e.next=11;break}return e.next=7,t.$store.dispatch("loadTopikKap");case 7:t.optionsTopik=e.sent,t.currentOptionsTopik=t.optionsTopik,e.next=21;break;case 11:if("update"!=t.mode){e.next=21;break}return t.loading=!0,e.next=15,t.$store.dispatch("loadTopikKapEdit");case 15:return t.optionsTopik=e.sent,e.next=18,t.loadKapById();case 18:a=t.optionsRendal.filter((function(e){return e.id==t.form.idUnitKerjaKap})),t.selectedRendal=a[0],t.editData.idTopik.split(",").map((function(t){return Number(t)})).forEach((function(e){t.addTopik(e)}));case 21:case"end":return e.stop()}}),e)})))()},methods:{viewSelectSearch:function(t){var e=t.alias,a=t.deskripsi;return"".concat(e," - ").concat(a)},addTopik:function(t){var e=this,a=this.optionsTopik.filter((function(e){return e.idTopik==t}))[0],n={idTopik:a.idTopik,nama:a.namaTopik,pj:a.unitKerja,deskripsi:a.deskripsi};this.topiks.push(n),this.form.dataTopik.push(n.idTopik),this.currentOptionsTopik=this.optionsTopik.filter((function(t){return!e.form.dataTopik.includes(t.idTopik)})),this.idTopik=null,this.selectedTopik=null},hapusTopikLokal:function(t){var e=this;this.topiks=this.topiks.filter((function(e){return e.idTopik!=t}));var a=this.form.dataTopik.indexOf(t);a>-1&&this.form.dataTopik.splice(a,1),this.currentOptionsTopik=this.optionsTopik.filter((function(t){return!e.form.dataTopik.includes(t.idTopik)}))},submit:function(){var t=this;return(0,z.Z)(regeneratorRuntime.mark((function e(){var a,n,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.$func.isNullOfObjElement(t.form),a&&0!=t.topiks.length){e.next=5;break}t.toastWarning("Lengkapi data sebelum submit!"),e.next=27;break;case 5:if(t.submitted=!0,n=t.appendToFormData(),e.prev=7,"create"!=t.mode){e.next=16;break}return t.loading=!0,e.next=12,N()({method:"POST",baseURL:t.$apiAddress,url:"/api/kap",data:n,params:{token:localStorage.getItem("token")}});case 12:i=e.sent,200!=i.status?t.error="Gagal menyimpan data":(t.loading=!1,t.$router.push("/kap"),t.toastSuccess("Berhasil menyimpan data")),e.next=22;break;case 16:if("update"!=t.mode){e.next=22;break}return t.loading=!0,e.next=20,N()({method:"POST",baseURL:t.$apiAddress,url:"/api/kap/".concat(t.idKap),data:n,params:{token:localStorage.getItem("token")}});case 20:o=e.sent,200!=o.status?t.error="Gagal merubah data":(t.loading=!1,t.$router.push("/kap"),t.toastSuccess("Berhasil merubah data"));case 22:e.next=27;break;case 24:e.prev=24,e.t0=e["catch"](7),setTimeout((function(){t.loading=!1,t.toastError("Terjadi kesalahan saat submit data")}),500);case 27:case"end":return e.stop()}}),e,null,[[7,24]])})))()},reset:function(){this.form=this.getEmptyForm(),this.submitted=!1,this.selectedRendal=null,this.currentOptionsTopik=this.optionsTopik,this.topiks=[]},getEmptyForm:function(){return{tahun:null,namaKap:null,idUnitKerjaKap:null,dataTopik:[]}},appendToFormData:function(){var t=new FormData;return"update"==this.mode&&t.append("_method","PUT"),t.append("tahun",this.form.tahun),t.append("namaKap",this.form.namaKap),t.append("idUnitKerjaKap",this.form.idUnitKerjaKap),t.append("idTopik",this.form.dataTopik.toString()),t.append("nip",localStorage.getItem("nip")),t},loadKapById:function(){var t=this;return(0,z.Z)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N()({method:"GET",baseURL:t.$apiAddress,url:"/api/kap/".concat(t.idKap),params:{token:localStorage.getItem("token")}});case 3:return a=e.sent,e.next=6,a.data;case 6:t.editData=e.sent,200==a.status&&(t.form={tahun:t.editData.tahun,namaKap:t.editData.namaKap,idUnitKerjaKap:t.editData.idUnitKerjaKap,dataTopik:[]}),t.loading=!1,e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),t.toastError(e.t0.message),t.loading=!1;case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},toastSuccess:function(t){this.$toast.open({message:t,type:"success",position:"top-right",duration:3e3})},toastError:function(t){this.$toast.open({message:t,type:"error",position:"top-right",duration:3e3})},toastWarning:function(t){this.$toast.open({message:t,type:"warning",position:"top-right",duration:3e3})}}},Y=a(40089);const Q=(0,Y.Z)(M,[["render",q]]);var X=Q}}]);
//# sourceMappingURL=129-legacy.4d22c3f8.js.map