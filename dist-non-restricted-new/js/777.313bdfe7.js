"use strict";(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[777],{9777:function(e,t,a){a.d(t,{Z:function(){return Z}});var i=a(3396),o=a(9242);const s={key:0,class:"h4 mb-4"},l={key:1,class:"h4 mb-4"},n=(0,i.Uk)("ID "),d={class:"col-sm-2"},r=(0,i.Uk)("Tahun "),m=(0,i._)("span",{class:"text-red-500"},"*",-1),u={class:"col-sm-2"},p=(0,i.Uk)("Nama Sektor "),c=(0,i._)("span",{class:"text-red-500"},"*",-1),h={class:"col-sm-9"},f=(0,i.Uk)("Nama Tema "),k=(0,i._)("span",{class:"text-red-500"},"*",-1),w={class:"col-sm-9"},T=(0,i.Uk)("Nama Topik "),b=(0,i._)("span",{class:"text-red-500"},"*",-1),_={class:"col-sm-9"},g=(0,i.Uk)("Informasi Topik Yang Diharapkan"),S=(0,i._)("span",{class:"text-red-500"},"*",-1),U=(0,i.Uk)(" Hapus "),W=(0,i.Uk)(" Simpan "),y=(0,i.Uk)("Kedeputian Koord Topik "),v=(0,i._)("span",{class:"text-red-500"},"*",-1),V={class:"col-sm-9"},I=(0,i.Uk)("Unit Kerja PJ Topik "),D=(0,i._)("span",{class:"text-red-500"},"*",-1),C={class:"col-sm-9"},L=(0,i.Uk)("Triwulan Pelaporan Topik "),$=(0,i._)("span",{class:"text-red-500"},"*",-1),x={class:"col-sm-4"},j=(0,i.Uk)(" Batal "),K=(0,i.Uk)(" Reset "),R={key:0},P=(0,i.Uk)(" Simpan "),E={key:1};function F(e,t,a,F,N,q){const B=(0,i.up)("Loading"),O=(0,i.up)("CFormLabel"),A=(0,i.up)("CFormInput"),H=(0,i.up)("CRow"),M=(0,i.up)("VueMultiselect"),Z=(0,i.up)("CCol"),z=(0,i.up)("CFormTextarea"),G=(0,i.up)("CButton"),Y=(0,i.up)("CForm"),J=(0,i.up)("CSpinner"),Q=(0,i.up)("CCardBody"),X=(0,i.up)("CCard");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(B,{active:N.loading,"onUpdate:active":t[0]||(t[0]=e=>N.loading=e),"is-full-page":!0},null,8,["active"]),(0,i.Wm)(X,{class:"mb-4"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{class:"p-4"},{default:(0,i.w5)((()=>["create"==a.mode?((0,i.wg)(),(0,i.iD)("h4",s,"Tambah Topik")):"update"==a.mode?((0,i.wg)(),(0,i.iD)("h4",l,"Edit Topik")):(0,i.kq)("",!0),"update"==a.mode?((0,i.wg)(),(0,i.j4)(H,{key:2,class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{for:"tahun",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[n])),_:1}),(0,i._)("div",d,[(0,i.Wm)(A,{modelValue:N.editData.idTopik,"onUpdate:modelValue":t[1]||(t[1]=e=>N.editData.idTopik=e),readonly:""},null,8,["modelValue"])])])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(Y,{onSubmit:(0,o.iM)(q.submit,["prevent"])},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{for:"tahun",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[r,m])),_:1}),(0,i._)("div",u,[(0,i.Wm)(A,{type:"number",id:"tahun",modelValue:N.form.tahun,"onUpdate:modelValue":t[2]||(t[2]=e=>N.form.tahun=e),readonly:"",required:""},null,8,["modelValue"])])])),_:1}),(0,i.Wm)(H,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{for:"nama-sektor",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[p,c])),_:1}),(0,i._)("div",h,[(0,i.Wm)(M,{id:"nama-sektor",modelValue:N.selectedSektor,"onUpdate:modelValue":t[3]||(t[3]=e=>N.selectedSektor=e),options:N.optionsSektor,placeholder:"Pilih Sektor",label:"deskripsi","track-by":"deskripsi","custom-label":q.viewSelectSektor},null,8,["modelValue","options","custom-label"])])])),_:1}),(0,i.Wm)(H,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{for:"nama-tema",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[f,k])),_:1}),(0,i._)("div",w,[(0,i.Wm)(M,{id:"nama-tema",modelValue:N.selectedTema,"onUpdate:modelValue":t[4]||(t[4]=e=>N.selectedTema=e),options:N.optionsTema,placeholder:"Pilih Tema",label:"deskripsi","track-by":"deskripsi","custom-label":q.viewSelectTema},null,8,["modelValue","options","custom-label"])])])),_:1}),(0,i.Wm)(H,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{for:"nama-topik",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[T,b])),_:1}),(0,i._)("div",_,[(0,i.Wm)(A,{type:"text",id:"nama-topik",modelValue:N.form.namaTopik,"onUpdate:modelValue":t[5]||(t[5]=e=>N.form.namaTopik=e),required:""},null,8,["modelValue"])])])),_:1}),(0,i.Wm)(H,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{sm:"3"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{for:"sumber-dana",class:"col-form-label"},{default:(0,i.w5)((()=>[g,S])),_:1})])),_:1}),(0,i.Wm)(Z,{sm:"9"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.infoTopikList,(e=>((0,i.wg)(),(0,i.j4)(H,{key:e.info,class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{sm:"8"},{default:(0,i.w5)((()=>[(0,i.Wm)(z,{rows:"1",type:"text",readonly:"",value:e.info},null,8,["value"])])),_:2},1024),(0,i.Wm)(Z,{sm:"2"},{default:(0,i.w5)((()=>[(0,i.Wm)(A,{type:"number",id:"info",placeholder:"No Urut",modelValue:e.nomorUrut,"onUpdate:modelValue":t=>e.nomorUrut=t,readonly:""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,i.Wm)(Z,{sm:"2"},{default:(0,i.w5)((()=>[(0,i.Wm)(G,{type:"submit",color:"danger",size:"",shape:"rounded-0",class:"w-full text-white",onClick:t=>q.deleteInfoTopik(e.nomorUrut)},{default:(0,i.w5)((()=>[U])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128)),(0,i.Wm)(Y,{onSubmit:(0,o.iM)(q.addInfoTopik,["prevent"])},{default:(0,i.w5)((()=>[(0,i.Wm)(H,null,{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{sm:"8"},{default:(0,i.w5)((()=>[(0,i.Wm)(A,{type:"text",id:"info",placeholder:"Info",modelValue:N.infoCurrentTopik,"onUpdate:modelValue":t[6]||(t[6]=e=>N.infoCurrentTopik=e),required:""},null,8,["modelValue"])])),_:1}),(0,i.Wm)(Z,{sm:"2"},{default:(0,i.w5)((()=>[(0,i.Wm)(A,{type:"number",id:"info",placeholder:"No Urut",modelValue:N.infoNomorUrut,"onUpdate:modelValue":t[7]||(t[7]=e=>N.infoNomorUrut=e),required:""},null,8,["modelValue"])])),_:1}),(0,i.Wm)(Z,{sm:"2"},{default:(0,i.w5)((()=>[(0,i.Wm)(G,{type:"submit",color:"primary",size:"",shape:"rounded-0",class:"w-full"},{default:(0,i.w5)((()=>[W])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1}),(0,i.Wm)(H,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{for:"deputi-topik",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[y,v])),_:1}),(0,i._)("div",V,[(0,i.Wm)(A,{type:"text",id:"dep-topik",value:N.viewDeputi,readonly:""},null,8,["value"])])])),_:1}),(0,i.Wm)(H,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{for:"pj-topik",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[I,D])),_:1}),(0,i._)("div",C,[(0,i.Wm)(M,{id:"pj-topik",modelValue:N.selectedRendal,"onUpdate:modelValue":t[8]||(t[8]=e=>N.selectedRendal=e),options:N.optionsRendal,placeholder:"Pilih Unit Kerja Penanggungjawab",label:"deskripsi","track-by":"deskripsi","custom-label":q.viewSelectSearch},null,8,["modelValue","options","custom-label"])])])),_:1}),(0,i.Wm)(H,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{for:"tw-topik",class:"col-sm-3 col-form-label"},{default:(0,i.w5)((()=>[L,$])),_:1}),(0,i._)("div",x,[(0,i.Wm)(M,{id:"tw-topik",modelValue:N.form.triwulan,"onUpdate:modelValue":t[9]||(t[9]=e=>N.form.triwulan=e),options:N.optionsTriwulan,multiple:!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pilih Triwulan"},null,8,["modelValue","options"])])])),_:1}),(0,i.Wm)(H,{class:"mt-8 view-form"},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{sm:"12",lg:"6",class:"mb-3"},{default:(0,i.w5)((()=>["view"!=a.mode?((0,i.wg)(),(0,i.j4)(G,{key:0,variant:"outline",color:"dark",onClick:t[10]||(t[10]=t=>e.$router.push("/topik")),class:"px-5",shape:"rounded-0"},{default:(0,i.w5)((()=>[j])),_:1})):(0,i.kq)("",!0)])),_:1}),"create"==a.mode||"update"==a.mode?((0,i.wg)(),(0,i.j4)(Z,{key:0,sm:"12",md:"6",class:"flex content-center justify-end pr-3 mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(G,{type:"button",class:"ml-1 px-5 text-white",color:"danger",onClick:q.reset,shape:"rounded-0"},{default:(0,i.w5)((()=>[K])),_:1},8,["onClick"]),(0,i.Wm)(G,{type:"submit",shape:"rounded-0",color:"info",class:"px-5 ml-2 text-white"},{default:(0,i.w5)((()=>[N.loading?((0,i.wg)(),(0,i.iD)("div",R,[(0,i.Wm)(J,{color:"white",size:"sm",class:"mr-2"}),P])):((0,i.wg)(),(0,i.iD)("p",E,"Simpan"))])),_:1})])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})],64)}var N=a(6265),q=a.n(N),B=a(6368),O=a(6216),A={components:{VueMultiselect:B.ZP,Loading:O.Z},props:["mode","idTopik"],data(){return{form:this.getEmptyForm(),submitted:!1,loading:!1,selectedSektor:null,optionsSektor:[],selectedTema:null,optionsTema:[],viewDeputi:null,selectedRendal:null,optionsRendal:[],optionsTriwulan:[1,2,3,4],editData:{},infoTopikList:[],infoCurrentTopik:"",infoNomorUrut:null}},watch:{selectedSektor:function(e){e&&(this.form.idSektor=e.idSektor,this.selectedTema="",this.getListTema())},selectedTema:function(e){e&&(this.form.idTema=e.idTema)},selectedRendal:function(e){e&&(this.form.idUnitKerja=e.id,this.form.idKedeputian=e.parentId,this.viewDeputi=`${e.deputi} - ${e.namaDeputi}`)}},async mounted(){if(this.form.tahun=localStorage.tahun,this.optionsSektor=await this.$store.dispatch("loadListSektor"),this.optionsRendal=await this.$store.dispatch("loadListUnitKontributor"),"update"==this.mode){this.loading=!0,await this.loadTopikById();const e=this.optionsSektor.filter((e=>e.idSektor==this.form.idSektor));this.selectedSektor=e[0],await this.getListTema();const t=this.optionsTema.filter((e=>e.idTema==this.form.idTema));this.selectedTema=t[0];const a=this.optionsRendal.filter((e=>e.id==this.form.idUnitKerja));this.selectedRendal=a[0];const i=await this.$store.dispatch("loadListInfoTopik",{idTopik:this.idTopik});this.infoTopikList=i.map((e=>({info:e.detailInfoTopik,nomorUrut:e.noUrut})))}},methods:{addInfoTopik(){this.infoTopikList.push({nomorUrut:this.infoNomorUrut,info:this.infoCurrentTopik}),this.infoCurrentTopik=""},deleteInfoTopik(e){this.infoTopikList.filter((t=>{t.nomorUrut==e&&this.infoTopikList.splice(this.infoTopikList.indexOf(t),1)}))},async getListTema(){this.optionsTema=await this.$store.dispatch("loadListTema",{idSektor:this.form.idSektor})},viewSelectSektor({namaSektor:e}){return`${e}`},viewSelectTema({namaTema:e}){return`${e}`},viewSelectSearch({alias:e,deskripsi:t}){return`${e} - ${t}`},async submit(){const e=this.$func.isNullOfObjElement(this.form);if(e){this.submitted=!0;const e=this.appendToFormData();try{if("create"==this.mode){this.loading=!0;const t=await q()({method:"POST",baseURL:this.$apiAddress,url:"/api/topik",data:e,params:{token:localStorage.getItem("token")}}),a=await t.data;this.infoTopikList.forEach((async e=>{const t={idTopik:a.id,idTema:parseInt(this.form.idTema),idSektor:parseInt(this.form.idSektor),detailInfoTopik:e.info,noUrut:parseInt(e.nomorUrut),nip:localStorage.getItem("nip")};await q()({method:"POST",baseURL:this.$apiAddress,url:"/api/infotopik",data:t,params:{token:localStorage.getItem("token")}})})),200!=t.status?this.error="Gagal menyimpan data":(this.loading=!1,this.$router.push("/topik"),this.toastSuccess("Berhasil menyimpan data"))}else if("update"==this.mode){this.loading=!0;const t=await q()({method:"POST",baseURL:this.$apiAddress,url:`/api/topik/${this.idTopik}`,data:e,params:{token:localStorage.getItem("token")}});this.infoTopikList.forEach((async e=>{const t={idTopik:this.idTopik,idTema:parseInt(this.form.idTema),idSektor:parseInt(this.form.idSektor),detailInfoTopik:e.info,noUrut:parseInt(e.nomorUrut),nip:localStorage.getItem("nip")};await q()({method:"POST",baseURL:this.$apiAddress,url:"/api/infotopik",data:t,params:{token:localStorage.getItem("token")}})})),200!=t.status?this.error="Gagal merubah data":(this.loading=!1,this.$router.push("/topik"),this.toastSuccess("Berhasil merubah data"))}}catch(t){setTimeout((()=>{this.loading=!1,this.toastError("Terjadi kesalahan saat submit data")}),500)}}else this.toastWarning("Lengkapi data sebelum submit!")},reset(){this.form=this.getEmptyForm(),this.submitted=!1,this.selectedSektor=null,this.selectedTema=null,this.viewDeputi=null,this.selectedRendal=null},getEmptyForm(){return{tahun:null,idSektor:null,idTema:null,namaTopik:null,idKedeputian:null,idUnitKerja:null,triwulan:null}},appendToFormData(){const e=new FormData;return"update"==this.mode&&e.append("_method","PATCH"),e.append("idSektor",this.form.idSektor),e.append("idTema",this.form.idTema),e.append("namaTopik",this.form.namaTopik),e.append("idKedeputian",this.form.idKedeputian),e.append("idUnitKerja",this.form.idUnitKerja),e.append("tahun",this.form.tahun),e.append("triwulan",this.form.triwulan),e.append("nip",localStorage.getItem("nip")),e},async loadTopikById(){try{const e=await q()({method:"GET",baseURL:this.$apiAddress,url:`/api/topik/${this.idTopik}`,params:{token:localStorage.getItem("token")}});this.editData=await e.data,200==e.status&&(this.form={tahun:this.editData.tahun,idSektor:this.editData.idSektor,idTema:this.editData.idTema,namaTopik:this.editData.namaTopik,idKedeputian:this.editData.idKedeputian,idUnitKerja:this.editData.idUnitKerja,triwulan:this.editData.triwulan}),this.loading=!1}catch(e){this.toastError(e.message),this.loading=!1}},toastSuccess(e){this.$toast.open({message:e,type:"success",position:"top-right",duration:3e3})},toastError(e){this.$toast.open({message:e,type:"error",position:"top-right",duration:3e3})},toastWarning(e){this.$toast.open({message:e,type:"warning",position:"top-right",duration:3e3})}}},H=a(89);const M=(0,H.Z)(A,[["render",F]]);var Z=M}}]);
//# sourceMappingURL=777.313bdfe7.js.map